Since we have a service and a version number, we can begin looking for a vulnerability to exploit. Searchsploit tells us that Joomla 3.7.0 is vulnerable to SQL injection.

<center>

![dbf7b5f5093d2e5e69069c09c2de9107.png](/Daily%20Bugle/_resources/dbf7b5f5093d2e5e69069c09c2de9107.png)

</center>

We use ``sqlmap -u http://10.10.50.236 --forms --crawl=10``, selecting all default options along the way. After a while, we don't get any results. One option is to do the SQLi manually; see [this link](https://github.com/hack3rman/TryHackMe/blob/master/Daily%20Bugle.md) for a nice writeup.

Some Googling tells us that we can also make use of [this script](https://github.com/XiphosResearch/exploits/tree/master/Joomblah), which is an exploit for Joomla 3.7.0. Run `python2.7 joomblah.py http://10.10.50.236`. (Note: I had to specifically use Python 2.7 here, as the script wasn't running properly.)

<center>

![1bd76d5497480cfbd64aa3c8feafba9a.png](/Daily%20Bugle/_resources/1bd76d5497480cfbd64aa3c8feafba9a.png)

</center>

We get a few usernames (one of which we already knew of from the webpage) together with a hash. Let's crack it with hashcat. I typically have some trouble using hashcat on a VM,  so I follow the methodology [here](https://samsclass.info/123/proj10/p12-hashcat.htm) to use an old version of hashcat which my VM could run.

```bash
/home/kali/hash/hashcat-cli32.bin -m 3200 -a 0 -o found.txt hash.txt /usr/share/wordlists/rockyou.txt
```

We specify the path to the binary, and we use:
- `-m` to specify the mode. In this case, I chose 3200 according the list of [hashcat examples](https://hashcat.net/wiki/doku.php?id=example_hashes).
- `-a` specifies the attack mode. 0 corresponds to a dictionary attack.
- `-o` specifies the output file.
- We then specify the file with our hashes (in this case just one), and the path to the wordlist. In this case, we're using `rockyou.txt`.

After exactly 1h 15m, the hash was cracked. This would have gone faster if I had used my Windows host machine to run hashcat, as opposed to my Kali VM image.

<center>

![afd68c9a45b3e5ad65d0a91905a165b4.png](/Daily%20Bugle/_resources/afd68c9a45b3e5ad65d0a91905a165b4.png)

![35d0c711d7e5c2e106a9637df095cc1a.png](/Daily%20Bugle/_resources/35d0c711d7e5c2e106a9637df095cc1a.png)

</center>

Now we can log in to Jonah's Joomla account from the administrator login page we found earlier.

<center>

![901e4e8b85712ca547bd3dc0b82f8d01.png](/Daily%20Bugle/_resources/901e4e8b85712ca547bd3dc0b82f8d01.png)

</center>

Looking around, we eventually find a page which allows us to edit the templates associated with the Joomla CMS. If we click on the Beez3 template, we see a list of php file which we can potentially exploit. Let's look at the /index.php file.

<center>

![2efd186e9ae789e0f017c44337ab9493.png](/Daily%20Bugle/_resources/2efd186e9ae789e0f017c44337ab9493.png)

![d9052a8b13b38bdca3e0b2f3d269a9b8.png](/Daily%20Bugle/_resources/d9052a8b13b38bdca3e0b2f3d269a9b8.png)

</center>

We will use the standard [Pentestmonkey php reverse shell](https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php). We copy and paste the shell code into the /index.php file, making sure to use our attacking machine IP and a port of our choice.

<center>

![1fb736dbb57acf3a7ab718fb45c1e930.png](/Daily%20Bugle/_resources/1fb736dbb57acf3a7ab718fb45c1e930.png)

</center>

Now set up a netcat listener and navigate to `http://10.10.76.10/templates/beez3/index.php` to catch the reverse shell, giving us initial access.

<center>

![cd460351fcc4cf08333b8354fe9269ac.png](/Daily%20Bugle/_resources/cd460351fcc4cf08333b8354fe9269ac.png)

</center>